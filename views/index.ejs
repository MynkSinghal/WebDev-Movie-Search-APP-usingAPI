<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MovieFlix - Discover Movies</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <i class="fas fa-film"></i>
                <span>MovieFlix</span>
            </div>
            <div class="nav-links">
                <a href="/" class="nav-link active">Home</a>
                <a href="#trending" class="nav-link">Trending</a>
                <a href="#popular" class="nav-link">Popular</a>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-content">
            <div class="hero-text">
                <h1 class="hero-title">
                    Discover Your Next 
                    <span class="gradient-text">Favorite Movie</span>
                </h1>
                <p class="hero-subtitle">
                    Explore millions of movies, get detailed information, watch trailers, and discover new favorites with our comprehensive movie database.
                </p>
            </div>
            
            <!-- Search Section -->
            <div class="search-container">
                <form action="/search" method="POST" class="search-form">
                    <div class="search-input-container">
                        <i class="fas fa-search search-icon"></i>
                        <input 
                            type="text" 
                            name="movieName" 
                            placeholder="Search for movies..." 
                            class="search-input"
                            autocomplete="off"
                            required
                        >
                        <div class="search-suggestions" id="searchSuggestions"></div>
                    </div>
                    <button type="submit" class="search-btn">
                        <span>Search</span>
                        <i class="fas fa-arrow-right"></i>
                    </button>
                </form>
                
                <% if (error) { %>
                    <div class="error-message">
                        <i class="fas fa-exclamation-circle"></i>
                        <span><%= error %></span>
                    </div>
                <% } %>
            </div>
        </div>
        
        <!-- Animated Background -->
        <div class="hero-background">
            <div class="floating-shapes">
                <div class="shape shape-1"></div>
                <div class="shape shape-2"></div>
                <div class="shape shape-3"></div>
                <div class="shape shape-4"></div>
            </div>
        </div>
    </section>

    <!-- Trending Movies Section -->
    <% if (trending && trending.length > 0) { %>
    <section class="movies-section" id="trending">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">
                    <i class="fas fa-fire"></i>
                    Trending Today
                </h2>
                <p class="section-subtitle">The most popular movies right now</p>
            </div>
            
            <div class="movies-grid">
                <% trending.forEach(function(movie) { %>
                    <div class="movie-card" onclick="window.location.href='/movie/<%= movie.id %>'">
                        <div class="movie-poster">
                            <% if (movie.poster_path) { %>
                                <img src="<%= imageBaseUrl %><%= movie.poster_path %>" alt="<%= movie.title %>" loading="lazy">
                            <% } else { %>
                                <div class="no-poster">
                                    <i class="fas fa-image"></i>
                                    <span>No Image</span>
                                </div>
                            <% } %>
                            <div class="movie-overlay">
                                <div class="movie-rating">
                                    <i class="fas fa-star"></i>
                                    <span><%= movie.vote_average ? movie.vote_average.toFixed(1) : 'N/A' %></span>
                                </div>
                                <button class="play-btn">
                                    <i class="fas fa-play"></i>
                                </button>
                            </div>
                        </div>
                        <div class="movie-info">
                            <h3 class="movie-title"><%= movie.title %></h3>
                            <p class="movie-year">
                                <%= movie.release_date ? new Date(movie.release_date).getFullYear() : 'N/A' %>
                            </p>
                        </div>
                    </div>
                <% }); %>
            </div>
        </div>
    </section>
    <% } %>

    <!-- Popular Movies Section -->
    <% if (popular && popular.length > 0) { %>
    <section class="movies-section" id="popular">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">
                    <i class="fas fa-star"></i>
                    Popular Movies
                </h2>
                <p class="section-subtitle">Highly rated and loved by audiences</p>
            </div>
            
            <div class="movies-grid">
                <% popular.forEach(function(movie) { %>
                    <div class="movie-card" onclick="window.location.href='/movie/<%= movie.id %>'">
                        <div class="movie-poster">
                            <% if (movie.poster_path) { %>
                                <img src="<%= imageBaseUrl %><%= movie.poster_path %>" alt="<%= movie.title %>" loading="lazy">
                            <% } else { %>
                                <div class="no-poster">
                                    <i class="fas fa-image"></i>
                                    <span>No Image</span>
                                </div>
                            <% } %>
                            <div class="movie-overlay">
                                <div class="movie-rating">
                                    <i class="fas fa-star"></i>
                                    <span><%= movie.vote_average ? movie.vote_average.toFixed(1) : 'N/A' %></span>
                                </div>
                                <button class="play-btn">
                                    <i class="fas fa-play"></i>
                                </button>
                            </div>
                        </div>
                        <div class="movie-info">
                            <h3 class="movie-title"><%= movie.title %></h3>
                            <p class="movie-year">
                                <%= movie.release_date ? new Date(movie.release_date).getFullYear() : 'N/A' %>
                            </p>
                        </div>
                    </div>
                <% }); %>
            </div>
        </div>
    </section>
    <% } %>

    <!-- About Section -->
    <section class="about-section">
        <div class="container">
            <div class="about-content">
                <div class="about-text">
                    <h2>About MovieFlix</h2>
                    <p>
                        MovieFlix is your ultimate destination for discovering movies. Our comprehensive database, 
                        powered by The Movie Database (TMDB), provides you with detailed information about millions 
                        of movies including ratings, cast, crew, trailers, and much more.
                    </p>
                    <div class="features">
                        <div class="feature">
                            <i class="fas fa-search"></i>
                            <span>Advanced Search</span>
                        </div>
                        <div class="feature">
                            <i class="fas fa-star"></i>
                            <span>User Ratings</span>
                        </div>
                        <div class="feature">
                            <i class="fas fa-video"></i>
                            <span>Trailers & Videos</span>
                        </div>
                        <div class="feature">
                            <i class="fas fa-users"></i>
                            <span>Cast & Crew Info</span>
                        </div>
                    </div>
                </div>
                <div class="about-visual">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <h3>1M+</h3>
                            <p>Movies</p>
                        </div>
                        <div class="stat-card">
                            <h3>500K+</h3>
                            <p>People</p>
                        </div>
                        <div class="stat-card">
                            <h3>100+</h3>
                            <p>Countries</p>
                        </div>
                        <div class="stat-card">
                            <h3>50+</h3>
                            <p>Languages</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-brand">
                    <i class="fas fa-film"></i>
                    <span>MovieFlix</span>
                </div>
                <p class="footer-text">
                    Powered by <a href="https://www.themoviedb.org/" target="_blank">The Movie Database (TMDB)</a>
                </p>
            </div>
        </div>
    </footer>

    <!-- Loading Animation -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner">
            <div class="spinner"></div>
            <p>Searching movies...</p>
        </div>
    </div>

    <script>
        // Search suggestions functionality
        const searchInput = document.querySelector('.search-input');
        const searchSuggestions = document.getElementById('searchSuggestions');
        let searchTimeout;

        searchInput.addEventListener('input', function() {
            const query = this.value.trim();
            
            clearTimeout(searchTimeout);
            
            if (query.length < 2) {
                searchSuggestions.style.display = 'none';
                return;
            }
            
            searchTimeout = setTimeout(async () => {
                try {
                    const response = await fetch(`/api/search/${encodeURIComponent(query)}`);
                    const data = await response.json();
                    
                    if (data.results && data.results.length > 0) {
                        searchSuggestions.innerHTML = data.results.map(movie => `
                            <div class="suggestion-item" onclick="selectSuggestion('${movie.title}', ${movie.id})">
                                <div class="suggestion-poster">
                                    ${movie.poster ? `<img src="${movie.poster}" alt="${movie.title}">` : '<i class="fas fa-image"></i>'}
                                </div>
                                <div class="suggestion-info">
                                    <div class="suggestion-title">${movie.title}</div>
                                    <div class="suggestion-year">${movie.year}</div>
                                </div>
                            </div>
                        `).join('');
                        searchSuggestions.style.display = 'block';
                    } else {
                        searchSuggestions.style.display = 'none';
                    }
                } catch (error) {
                    console.error('Search suggestion error:', error);
                    searchSuggestions.style.display = 'none';
                }
            }, 300);
        });

        function selectSuggestion(title, id) {
            window.location.href = `/movie/${id}`;
        }

        // Hide suggestions when clicking outside
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.search-input-container')) {
                searchSuggestions.style.display = 'none';
            }
        });

        // Show loading animation on form submit
        document.querySelector('.search-form').addEventListener('submit', function() {
            document.getElementById('loadingOverlay').style.display = 'flex';
        });

        // Smooth scrolling for navigation links
        document.querySelectorAll('.nav-link[href^="#"]').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth' });
                }
            });
        });

        // Parallax effect for hero section
        window.addEventListener('scroll', function() {
            const scrolled = window.pageYOffset;
            const parallax = document.querySelector('.hero-background');
            const speed = scrolled * 0.5;
            parallax.style.transform = `translateY(${speed}px)`;
        });
    </script>
</body>
</html>
